# Claude Code Memory System - Environment Configuration
# Copy this file to .env and customize as needed

# ============================================================================
# Core Configuration
# ============================================================================

# Qdrant Vector Database
QDRANT_HOST=localhost
QDRANT_PORT=6333

# Neo4j Knowledge Graph (Optional)
# NEO4J_URI=bolt://localhost:7687
# NEO4J_USER=neo4j
# NEO4J_PASSWORD=your_password_here

# Logging Level
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR

# ============================================================================
# Feature Flags (All Optional - Default: false)
# ============================================================================

# Learned Fusion Weights
# Adaptive query-based dense/sparse weighting for better search relevance
# Impact: +25-30% search quality
USE_LEARNED_FUSION=false

# Query Understanding
# Intelligent query classification and routing
# Impact: +40% routing efficiency, faster exact matches
USE_QUERY_UNDERSTANDING=false

# ============================================================================
# Cache Configuration
# ============================================================================

# Semantic cache similarity threshold (0.0 - 1.0)
# Lower = more cache hits, Higher = more precise matches
# Recommended: 0.85 - 0.90
# Default: 0.87 (4x hit rate vs 0.95)
CACHE_SIMILARITY_THRESHOLD=0.87

# Cache TTL in seconds (default: 86400 = 24 hours)
CACHE_TTL=86400

# Max cache entries (default: 1000)
MAX_CACHE_ENTRIES=1000

# ============================================================================
# Search Configuration
# ============================================================================

# Enable hybrid search (dense + sparse vectors)
# Requires fastembed library
HYBRID_SEARCH_ENABLED=true

# Enable cross-encoder reranking
# Improves search quality by 30-50%
RERANKING_ENABLED=true

# Default search mode: semantic, keyword, hybrid
DEFAULT_SEARCH_MODE=hybrid

# ============================================================================
# Consolidation Configuration
# ============================================================================

# Similarity threshold for deduplication (0.0 - 1.0)
# Higher = stricter matching (less consolidation)
DEDUP_THRESHOLD=0.92

# Consolidation clustering threshold
# Higher = fewer clusters (more aggressive merging)
CONSOLIDATION_THRESHOLD=0.85

# Use hierarchical clustering (vs greedy)
# Better semantic groupings, requires sklearn
USE_HIERARCHICAL_CLUSTERING=true

# ============================================================================
# API Configuration
# ============================================================================

# API host and port
API_HOST=0.0.0.0
API_PORT=8100

# CORS origins (comma-separated)
CORS_ORIGINS=http://localhost:5173,http://localhost:3000

# Max request body size (bytes)
MAX_REQUEST_SIZE=10485760  # 10MB

# ============================================================================
# Performance Tuning
# ============================================================================

# Embedding batch size
EMBEDDING_BATCH_SIZE=32

# Max concurrent embeddings
MAX_CONCURRENT_EMBEDDINGS=4

# Search result candidate multiplier for reranking
RERANK_CANDIDATE_MULTIPLIER=5

# ============================================================================
# Development Options
# ============================================================================

# Enable debug endpoints
DEBUG_ENDPOINTS=false

# Detailed error responses
DETAILED_ERRORS=false

# Request logging
LOG_REQUESTS=false

# ============================================================================
# Notes
# ============================================================================

# Feature Flag Impact Summary:
# - USE_LEARNED_FUSION: Better search relevance, slight latency increase
# - USE_QUERY_UNDERSTANDING: Faster exact matches, smarter routing
# - HYBRID_SEARCH_ENABLED: Best accuracy, requires more memory
# - RERANKING_ENABLED: +30-50% accuracy, adds 50-100ms latency

# Performance Recommendations:
# - For fastest response: hybrid=false, reranking=false
# - For best accuracy: hybrid=true, reranking=true, learned_fusion=true
# - For balanced: hybrid=true, reranking=true, learned_fusion=false (default)

# Cache Tuning:
# - Low threshold (0.80): More hits, less precise
# - High threshold (0.95): Fewer hits, very precise
# - Recommended: 0.87 (sweet spot for 4x hit rate)
